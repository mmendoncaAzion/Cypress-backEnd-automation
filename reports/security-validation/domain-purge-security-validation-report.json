{
  "metadata": {
    "timestamp": "2025-09-24T13:25:28.077Z",
    "environment": "stage",
    "testType": "domain-purge-security-validation",
    "reportVersion": "1.0"
  },
  "executionSummary": {
    "totalTests": 15,
    "vulnerabilitiesFound": 8,
    "securityPassed": 0,
    "securityFailed": 8,
    "timestamp": "2025-09-24T13:25:24.927Z",
    "environment": "stage",
    "criticalFindings": [
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-1.example.com",
        "description": "Account B successfully purged content for domain test-security-domain-1.example.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-2.azion.net",
        "description": "Account B successfully purged content for domain test-security-domain-2.azion.net owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-2.azion.net/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "vulnerable-domain.test.com",
        "description": "Account B successfully purged content for domain vulnerable-domain.test.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://vulnerable-domain.test.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "cross-account-test.domain.org",
        "description": "Account B successfully purged content for domain cross-account-test.domain.org owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://cross-account-test.domain.org/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Wildcard Domain Purge",
        "description": "Attempt to purge all subdomains - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://*.example.com/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Path Traversal Purge",
        "description": "Attempt path traversal in purge URL - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/../../../"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Multiple Domain Purge",
        "description": "Attempt to purge multiple domains in single request - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/",
                "https://test-security-domain-2.azion.net/",
                "https://vulnerable-domain.test.com/",
                "https://cross-account-test.domain.org/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Cache Key Manipulation",
        "description": "Attempt to purge using cache key patterns - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/cachekey",
            "body": {
              "cache_key": "custom-cache-key-*",
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      }
    ],
    "recommendations": [
      "Implement domain ownership validation before purge operations",
      "Add cross-account access controls for purge endpoints",
      "Implement audit logging for all purge operations",
      "Add rate limiting for purge operations per account",
      "Validate domain ownership against account workloads"
    ]
  },
  "securityFindings": {
    "timestamp": "2025-09-24T13:25:24.927Z",
    "environment": "stage",
    "testType": "domain-purge-security",
    "scenarios": [
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "test-security-domain-1.example.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-1",
            "domain_name": "test-security-domain-1.example.com",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "test-security-domain-1.example.com",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.323Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "test-security-domain-2.azion.net",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-2",
            "domain_name": "test-security-domain-2.azion.net",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "test-security-domain-2.azion.net",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.469Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "vulnerable-domain.test.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-3",
            "domain_name": "vulnerable-domain.test.com",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "vulnerable-domain.test.com",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.605Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "cross-account-test.domain.org",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-4",
            "domain_name": "cross-account-test.domain.org",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "cross-account-test.domain.org",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.707Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "test-security-domain-1.example.com",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.766Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "test-security-domain-2.azion.net",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-2.azion.net/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.863Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "vulnerable-domain.test.com",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://vulnerable-domain.test.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.921Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "cross-account-test.domain.org",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://cross-account-test.domain.org/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.003Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "wildcard_domain_purge",
        "description": "Attempt to purge all subdomains",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://*.example.com/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.052Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "path_traversal_purge",
        "description": "Attempt path traversal in purge URL",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/../../../"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.121Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "multiple_domain_purge",
        "description": "Attempt to purge multiple domains in single request",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/",
              "https://test-security-domain-2.azion.net/",
              "https://vulnerable-domain.test.com/",
              "https://cross-account-test.domain.org/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.169Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "cache_key_manipulation",
        "description": "Attempt to purge using cache key patterns",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/cachekey",
          "body": {
            "cache_key": "custom-cache-key-*",
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.240Z"
      },
      {
        "phase": "legitimate_operations",
        "action": "owner_purge",
        "domain": "test-security-domain-1.example.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/legitimate-test"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.340Z"
      }
    ],
    "vulnerabilities": [
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-1.example.com",
        "description": "Account B successfully purged content for domain test-security-domain-1.example.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-2.azion.net",
        "description": "Account B successfully purged content for domain test-security-domain-2.azion.net owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-2.azion.net/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "vulnerable-domain.test.com",
        "description": "Account B successfully purged content for domain vulnerable-domain.test.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://vulnerable-domain.test.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "cross-account-test.domain.org",
        "description": "Account B successfully purged content for domain cross-account-test.domain.org owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://cross-account-test.domain.org/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Wildcard Domain Purge",
        "description": "Attempt to purge all subdomains - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://*.example.com/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Path Traversal Purge",
        "description": "Attempt path traversal in purge URL - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/../../../"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Multiple Domain Purge",
        "description": "Attempt to purge multiple domains in single request - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/",
                "https://test-security-domain-2.azion.net/",
                "https://vulnerable-domain.test.com/",
                "https://cross-account-test.domain.org/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Cache Key Manipulation",
        "description": "Attempt to purge using cache key patterns - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/cachekey",
            "body": {
              "cache_key": "custom-cache-key-*",
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      }
    ],
    "summary": {
      "totalTests": 15,
      "vulnerabilitiesFound": 8,
      "securityPassed": 0,
      "securityFailed": 8
    }
  },
  "recommendations": [
    "Implement domain ownership validation before purge operations",
    "Add cross-account access controls for purge endpoints",
    "Implement audit logging for all purge operations",
    "Add rate limiting for purge operations per account",
    "Validate domain ownership against account workloads"
  ],
  "evidence": {
    "scenarios": [
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "test-security-domain-1.example.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-1",
            "domain_name": "test-security-domain-1.example.com",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "test-security-domain-1.example.com",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.323Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "test-security-domain-2.azion.net",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-2",
            "domain_name": "test-security-domain-2.azion.net",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "test-security-domain-2.azion.net",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.469Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "vulnerable-domain.test.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-3",
            "domain_name": "vulnerable-domain.test.com",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "vulnerable-domain.test.com",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.605Z"
      },
      {
        "phase": "setup",
        "action": "create_workload",
        "domain": "cross-account-test.domain.org",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/edge_applications",
          "body": {
            "name": "security-test-workload-4",
            "domain_name": "cross-account-test.domain.org",
            "active": true,
            "delivery_protocol": "http,https",
            "origin_type": "single_origin",
            "address": "httpbin.org",
            "origin_protocol_policy": "preserve",
            "host_header": "cross-account-test.domain.org",
            "browser_cache_settings": "honor",
            "cdn_cache_settings": "honor"
          }
        },
        "response": {
          "status": 404,
          "body": {
            "errors": [
              {
                "code": "10004",
                "title": "Not Found",
                "detail": "Not found.",
                "status": "404"
              }
            ]
          }
        },
        "timestamp": "2025-09-24T13:25:25.707Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "test-security-domain-1.example.com",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.766Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "test-security-domain-2.azion.net",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-2.azion.net/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.863Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "vulnerable-domain.test.com",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://vulnerable-domain.test.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:25.921Z"
      },
      {
        "phase": "cross_account_test",
        "action": "purge_attempt",
        "domain": "cross-account-test.domain.org",
        "attackerAccountId": "fake-account-id",
        "targetAccountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://cross-account-test.domain.org/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.003Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "wildcard_domain_purge",
        "description": "Attempt to purge all subdomains",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://*.example.com/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.052Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "path_traversal_purge",
        "description": "Attempt path traversal in purge URL",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/../../../"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.121Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "multiple_domain_purge",
        "description": "Attempt to purge multiple domains in single request",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/",
              "https://test-security-domain-2.azion.net/",
              "https://vulnerable-domain.test.com/",
              "https://cross-account-test.domain.org/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.169Z"
      },
      {
        "phase": "advanced_attacks",
        "action": "cache_key_manipulation",
        "description": "Attempt to purge using cache key patterns",
        "attackerAccountId": "fake-account-id",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/cachekey",
          "body": {
            "cache_key": "custom-cache-key-*",
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.240Z"
      },
      {
        "phase": "legitimate_operations",
        "action": "owner_purge",
        "domain": "test-security-domain-1.example.com",
        "accountId": "25433",
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/legitimate-test"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        },
        "timestamp": "2025-09-24T13:25:26.340Z"
      }
    ],
    "vulnerabilities": [
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-1.example.com",
        "description": "Account B successfully purged content for domain test-security-domain-1.example.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "test-security-domain-2.azion.net",
        "description": "Account B successfully purged content for domain test-security-domain-2.azion.net owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-2.azion.net/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "vulnerable-domain.test.com",
        "description": "Account B successfully purged content for domain vulnerable-domain.test.com owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://vulnerable-domain.test.com/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Cross-Account Domain Purge",
        "domain": "cross-account-test.domain.org",
        "description": "Account B successfully purged content for domain cross-account-test.domain.org owned by Account A",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://cross-account-test.domain.org/test-path"
              ],
              "method": "delete"
            },
            "headers": {
              "Authorization": "Token fake-secondary-token"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Unauthorized users can purge content from domains they do not own",
        "recommendation": "Implement domain ownership validation before allowing purge operations"
      },
      {
        "severity": "CRITICAL",
        "type": "Wildcard Domain Purge",
        "description": "Attempt to purge all subdomains - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://*.example.com/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Path Traversal Purge",
        "description": "Attempt path traversal in purge URL - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/../../../"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Multiple Domain Purge",
        "description": "Attempt to purge multiple domains in single request - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/url",
            "body": {
              "urls": [
                "https://test-security-domain-1.example.com/",
                "https://test-security-domain-2.azion.net/",
                "https://vulnerable-domain.test.com/",
                "https://cross-account-test.domain.org/"
              ],
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      },
      {
        "severity": "CRITICAL",
        "type": "Cache Key Manipulation",
        "description": "Attempt to purge using cache key patterns - Attack succeeded",
        "evidence": {
          "request": {
            "method": "POST",
            "url": "https://stage-api.azion.com/v4/purge/cachekey",
            "body": {
              "cache_key": "custom-cache-key-*",
              "method": "delete"
            }
          },
          "response": {
            "status": 204
          }
        },
        "impact": "Advanced purge attack vectors are not properly blocked",
        "recommendation": "Implement comprehensive input validation and domain ownership checks"
      }
    ]
  },
  "executiveSummary": {
    "testStatus": "VULNERABILITIES_FOUND",
    "totalScenarios": 13,
    "totalVulnerabilities": 8,
    "criticalVulnerabilities": 8,
    "securityRisk": "HIGH",
    "complianceStatus": "NON_COMPLIANT"
  }
}